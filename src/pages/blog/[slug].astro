---
import PostCategories from "@/components/blog/PostCategories.astro";
import PostMeta from "@/components/blog/PostMeta.astro";
import Layout from "@/layouts/Layout.astro";
import { getPost } from "@/lib/wp";
import { Picture } from "astro:assets";

export const prerender = false;

const { slug } = Astro.params;
const post = await getPost(slug);
if (!post.success) return Astro.redirect("/404");
const { title, featured_images, date, category_details, content } = post.data;
---

<Layout
    title={title.rendered}
    subtitle={title.rendered}
    bgImage={featured_images.medium_large.url}
>
    <article class="space-y-5 max-w-4xl mx-auto">
        <PostMeta date={date} />
        {
            category_details.map((category) => (
                <PostCategories name={category.name} slug={category.slug} />
            ))
        }
        <Picture
            src={featured_images.medium_large.url}
            alt={`Imagen del Post: ${title.rendered}`}
            width={featured_images.medium_large.width}
            height={featured_images.medium_large.height}
            class="w-full"
        />

        <div
            set:html={content.rendered}
            class="text-lg space-y-3 mt-5 text-pretty"
        />
    </article>
</Layout>
