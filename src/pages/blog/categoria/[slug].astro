---
import type { GetStaticPaths } from "astro";
import Layaout from "@/layouts/Layout.astro";
import { getCategories, getCategory, getPostsByCategory } from "@/lib/wp";
import PostCard from "@/components/blog/PostCard.astro";

// Crear rutas dinámicas
export const getStaticPaths = (async () => {
    const categories = await getCategories();
    return categories.map((category) => ({
        params: { slug: category.slug },
    }));
}) satisfies GetStaticPaths;

// Información de la categoría
const { slug } = Astro.params;
const category = await getCategory(slug);

// Pots que pertenecen a esa categoría
const posts = await getPostsByCategory(category.id);
---

<Layaout
    title={`Post en la Categoría: ${category.name}`}
    subtitle={`Post en la Categoría: ${category.name}`}
    bgImage={posts[0].featured_images.full.url}
>
    {posts.map((post) => <PostCard post={post} />)}
</Layaout>
